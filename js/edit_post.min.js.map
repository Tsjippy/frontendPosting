{"version":3,"file":"edit_post.min.js","mappings":"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","sources":["webpack://frontend_posting/../../../plugins/sim-base/includes/js/partials/load_assets.js","webpack://frontend_posting/./edit_post.js"],"sourcesContent":["export let scripts;\r\n\r\nexport let afterScriptsLoaded\t= function (attachTo){\r\n    // load \r\n    if(typeof(tinymce) != 'undefined'){\r\n        tinymce.remove();\r\n\r\n        // Activate tinyMce's again\r\n        document.querySelectorAll('.entry-content .wp-editor-area').forEach(el =>{\r\n            window.tinyMCE.execCommand('mceAddEditor', false, el.id);\r\n        });\r\n    }    \r\n\r\n    // invoke dom content loaded events\r\n    window.document.dispatchEvent(new Event(\"DOMContentLoaded\", {\r\n        bubbles: true,\r\n        cancelable: true\r\n    }));\r\n\r\n    // Somehow the visual/text switch does not work, manually fix it\r\n    document.querySelectorAll('.wp-switch-editor').forEach(el=>el.addEventListener('click', ev=>{\r\n        let area    = el.closest('.wp-editor-wrap').querySelector('.wp-editor-area');\r\n        let panel   =  el.closest('.wp-editor-wrap').querySelector('.mce-panel');\r\n        area.style.visibility='unset';\r\n        if(ev.target.matches('.switch-tmce')){\r\n           panel.style.display='block';\r\n            area.style.display='none';\r\n        }else{\r\n            panel.style.display='none';\r\n            area.style.display='block';\r\n        }\r\n    }));\r\n\r\n    //add niceselects\r\n\tdocument.querySelectorAll('select:not(.nonice,.swal2-select)').forEach(function(select){\r\n        Main.attachNiceSelect(select);\r\n\t});\r\n\r\n    const ev = new Event('scriptsloaded');\r\n\tattachTo.dispatchEvent(ev);\r\n}\r\n\r\nexport let addStyles    = function (response, attachTo){\r\n    scripts     = [];\r\n    let temp    = document.createElement('div');\r\n\r\n    // parse inline scripts\r\n    temp.innerHTML =  response.html;\r\n    scripts = Array.prototype.slice.call(temp.getElementsByTagName('script'));\r\n\r\n    if(response.js){\r\n        temp.innerHTML =  response.js;\r\n        scripts\t= [...temp.children].concat(scripts);\r\n        addScripts(attachTo);\r\n    }\r\n\r\n    if(response.css){\r\n        temp.innerHTML = response.css;\r\n        [...temp.children].forEach(el => {\r\n            document.head.appendChild(el);\r\n        });\r\n    }\r\n}\r\n\r\nexport let addScripts\t= function (attachTo) {\r\n    if(attachTo == undefined){\r\n        return;\r\n    }\r\n\r\n    if(scripts.length == 0){\r\n        afterScriptsLoaded(attachTo);\r\n    }\r\n    let el\t= scripts.shift();\r\n\r\n    if(el == undefined){\r\n        afterScriptsLoaded(attachTo);\r\n        return;\r\n    }\r\n\r\n    // only add if needed\r\n    if(el.tagName == 'SCRIPT' && document.getElementById(el.id) == null){\r\n        var s = document.createElement('script');\r\n\r\n        if(el.type == ''){\r\n            s.type\t= 'text/javascript'; \r\n        }else{\r\n            s.type\t= el.type;\r\n        }\r\n\r\n        if(el.src != ''){\r\n            s.src \t= el.src;\r\n        }else{\r\n            s.innerHTML\t= el.innerHTML;\r\n        }\r\n        \r\n        s.id\t= el.id;\r\n        \r\n        try{\r\n            document.head.appendChild(s);\r\n        }catch (error) {\r\n            console.error(error);\r\n        }\r\n\r\n        if(scripts.length > 0){\r\n            if(el.src != ''){\r\n                s.addEventListener('load', addScripts.bind( null, attachTo ) );\r\n            }else{\r\n                addScripts(attachTo);\r\n            }\r\n        }else{\r\n            if(el.src != ''){\r\n                s.addEventListener('load', afterScriptsLoaded.bind( null, attachTo));\r\n            }else{\r\n                afterScriptsLoaded(attachTo);\r\n            }\t\t\t\r\n        }\r\n    }else if(scripts.length > 0){\r\n        // get next script\r\n        addScripts(attachTo);\r\n    }else{\r\n        afterScriptsLoaded(attachTo);\r\n    }\r\n}","import { addStyles } from '../../../plugins/sim-base/includes/js/partials/load_assets.js';\r\n\r\nconsole.log(\"Edit post.js loaded\");\r\n\r\nlet editPostSwitch = async function (event){\r\n\tlet button\t= event.target;\r\n\tlet wrapper\t= button.closest('div').querySelector('.content-wrapper');\r\n\tlet insertLocation\t= wrapper.parentNode;\r\n\r\n\tlet formData    = new FormData();\r\n    let postId      = button.dataset.postId;\r\n    formData.append('post-id', postId);\r\n\r\n\tconst url \t\t= new URL(edit_post_url);\r\n\turl.searchParams.set('post-id', postId);\r\n\r\n\twindow.history.pushState({}, '', url);\r\n\r\n\tlet loader\t\t= Main.showLoader(wrapper, true, 50, 'Requesting form...');\r\n\r\n\tlet response \t= await FormSubmit.fetchRestApi('frontend_posting/post_edit', formData);\r\n\r\n\tif(response){\r\n\t\t// Close any modals to restore scrolling\r\n\t\tMain.hideModals();\r\n\r\n\t\tlet div\t\t\t\t= document.createElement('div');\r\n\t\tdiv.classList.add('content-wrapper');\r\n\t\tdiv.innerHTML\t\t= response.html;\r\n\r\n\t\t// remove previous content\r\n\t\tdocument.querySelectorAll('.content-wrapper').forEach(el=>el.remove());\r\n\r\n\t\tinsertLocation.appendChild(div);\r\n\r\n\t\taddStyles(response, document);\t// runs also the afterScriptsLoaded function\r\n\r\n\t\tloader.remove();\r\n\t}else{\r\n\t\tloader.outerHTML\t= button.outerHTML;\r\n\t}\r\n}\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", function() {\r\n\t\r\n\tdocument.querySelectorAll('.page-edit.hidden').forEach(el=>{\r\n\t\tel.classList.remove('hidden');\r\n\t});\r\n});\r\n\r\ndocument.addEventListener(\"click\", function(ev) {\t\r\n\tif(ev.target.matches( '.page-edit')){\r\n\t\tev.stopImmediatePropagation();\r\n\t\teditPostSwitch(ev);\r\n\t}\r\n});\r\n\r\n// after scripts have been loaded over AJAX\r\ndocument.addEventListener(\"scriptsloaded\", function() {\r\n\tdocument.querySelectorAll('#frontend-upload-form').forEach(el=>el.classList.remove('hidden'));\r\n\r\n\tdocument.querySelectorAll('.content-wrapper').forEach(el=>el.classList.remove('hidden'));\r\n\tdocument.querySelectorAll('.loader-wrapper:not(.hidden)').forEach(el=>el.remove());\r\n});"],"names":["scripts","afterScriptsLoaded","attachTo","tinymce","remove","document","querySelectorAll","forEach","el","window","tinyMCE","execCommand","id","dispatchEvent","Event","bubbles","cancelable","addEventListener","ev","area","closest","querySelector","panel","style","visibility","target","matches","display","select","Main","attachNiceSelect","addScripts","undefined","length","shift","tagName","getElementById","s","createElement","type","src","innerHTML","head","appendChild","error","console","bind","log","classList","stopImmediatePropagation","async","event","button","wrapper","insertLocation","parentNode","formData","FormData","postId","dataset","append","url","URL","edit_post_url","searchParams","set","history","pushState","loader","showLoader","response","FormSubmit","fetchRestApi","hideModals","div","add","html","temp","Array","prototype","slice","call","getElementsByTagName","js","children","concat","css","addStyles","outerHTML","editPostSwitch"],"sourceRoot":""}